{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/profsteve/Documents/prisma-supabase-redis/app/pokemon/%5Bid%5D/page.tsx"],"sourcesContent":["// app/pokemon/[id]/page.tsx\n\"use client\"\n\nimport { useEffect, useState } from \"react\"\nimport { useParams, useRouter } from \"next/navigation\"\nimport Link from \"next/link\"\n\ntype PokemonDetail = {\n  id: number\n  name: string\n  spriteUrl: string\n  typePrimary: string\n  typeSecondary?: string | null\n  hp: number\n  attack: number\n  defense: number\n  speed: number\n}\n\ntype ApiResponse = {\n  pokemon: PokemonDetail\n  source: \"cache\" | \"db\"\n}\n\nexport default function PokemonDetailPage() {\n  const params = useParams()\n  const router = useRouter()\n  const id = params?.id as string\n\n  const [data, setData] = useState<ApiResponse | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [bustingCache, setBustingCache] = useState(false)\n\n  useEffect(() => {\n    if (!id) return\n\n    let cancelled = false\n\n    async function fetchPokemon() {\n      setLoading(true)\n      setError(null)\n\n      try {\n        const res = await fetch(`/api/pokemon/${id}`)\n        if (!res.ok) {\n          if (res.status === 404) {\n            throw new Error(\"Pok√©mon not found\")\n          }\n          throw new Error(\"Failed to fetch\")\n        }\n\n        const result = (await res.json()) as ApiResponse\n        if (!cancelled) {\n          setData(result)\n        }\n      } catch (err) {\n        if (!cancelled) {\n          setError(err instanceof Error ? err.message : \"Unknown error\")\n        }\n      } finally {\n        if (!cancelled) {\n          setLoading(false)\n        }\n      }\n    }\n\n    fetchPokemon()\n\n    return () => {\n      cancelled = true\n    }\n  }, [id])\n\n  async function handleBustCache() {\n    setBustingCache(true)\n    try {\n      await fetch(`/api/pokemon/${id}`, { method: \"POST\" })\n      // Refetch data\n      const res = await fetch(`/api/pokemon/${id}`)\n      if (res.ok) {\n        const result = (await res.json()) as ApiResponse\n        setData(result)\n      }\n    } catch (err) {\n      console.error(\"Failed to bust cache:\", err)\n    } finally {\n      setBustingCache(false)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"h-12 w-12 animate-spin rounded-full border-4 border-indigo-500/30 border-t-fuchsia-400\"></div>\n      </div>\n    )\n  }\n\n  if (error || !data) {\n    return (\n      <div className=\"space-y-4\">\n        <Link href=\"/\" className=\"inline-flex items-center gap-2 text-sm text-slate-300 hover:text-slate-100\">\n          <span>‚Üê</span> Back to Arena\n        </Link>\n        <div className=\"rounded-xl border border-slate-500/40 bg-slate-950/60 p-8 text-center\">\n          <p className=\"text-slate-400\">{error || \"Unknown error\"}</p>\n        </div>\n      </div>\n    )\n  }\n\n  const { pokemon, source } = data\n  const maxStat = Math.max(pokemon.hp, pokemon.attack, pokemon.defense, pokemon.speed)\n\n  return (\n    <div className=\"space-y-6\">\n      <Link href=\"/\" className=\"inline-flex items-center gap-2 text-sm text-slate-300 hover:text-slate-100\">\n        <span>‚Üê</span> Back to Arena\n      </Link>\n\n      <div className=\"rounded-2xl border border-indigo-500/40 bg-slate-950/60 p-6 shadow-[0_0_30px_rgba(56,189,248,0.2)]\">\n        <div className=\"flex flex-col items-center gap-6 md:flex-row md:items-start\">\n          {/* Sprite */}\n          <div className=\"relative\">\n            <div className=\"absolute inset-0 rounded-full bg-slate-900/40 blur-xl\"></div>\n            {/* eslint-disable-next-line @next/next/no-img-element */}\n            <img\n              src={pokemon.spriteUrl || \"/placeholder.svg\"}\n              alt={pokemon.name}\n              className=\"relative z-10 h-48 w-48 object-contain drop-shadow-[0_0_30px_rgba(248,250,252,0.9)]\"\n            />\n          </div>\n\n          {/* Details */}\n          <div className=\"flex-1 space-y-4\">\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <h1 className=\"text-3xl font-bold text-slate-50\">{pokemon.name}</h1>\n                <span\n                  className={`rounded-full px-3 py-1 text-xs font-medium ${\n                    source === \"cache\" ? \"bg-emerald-500/20 text-emerald-300\" : \"bg-amber-500/20 text-amber-300\"\n                  }`}\n                >\n                  {source === \"cache\" ? \"‚ö° From Cache\" : \"üê¢ From Database\"}\n                </span>\n              </div>\n              <div className=\"flex flex-wrap gap-2\">\n                <span className=\"rounded-full bg-slate-900/70 px-3 py-1 text-xs uppercase tracking-wide text-slate-100 ring-1 ring-slate-500/50\">\n                  {pokemon.typePrimary}\n                </span>\n                {pokemon.typeSecondary && (\n                  <span className=\"rounded-full bg-slate-900/70 px-3 py-1 text-xs uppercase tracking-wide text-slate-100 ring-1 ring-slate-500/50\">\n                    {pokemon.typeSecondary}\n                  </span>\n                )}\n              </div>\n            </div>\n\n            {/* Stats */}\n            <div className=\"space-y-3\">\n              <h2 className=\"text-sm font-semibold text-slate-300\">Base Stats</h2>\n              <div className=\"space-y-2\">\n                {[\n                  { label: \"HP\", value: pokemon.hp },\n                  { label: \"Attack\", value: pokemon.attack },\n                  { label: \"Defense\", value: pokemon.defense },\n                  { label: \"Speed\", value: pokemon.speed },\n                ].map((stat) => (\n                  <div key={stat.label} className=\"space-y-1\">\n                    <div className=\"flex items-center justify-between text-xs\">\n                      <span className=\"text-slate-400\">{stat.label}</span>\n                      <span className=\"font-semibold text-slate-200\">{stat.value}</span>\n                    </div>\n                    <div className=\"h-2 overflow-hidden rounded-full bg-slate-800/60\">\n                      <div\n                        className=\"h-full rounded-full bg-gradient-to-r from-indigo-500 to-fuchsia-500 transition-all\"\n                        style={{\n                          width: `${(stat.value / maxStat) * 100}%`,\n                        }}\n                      />\n                    </div>\n                  </div>\n                ))}\n              </div>\n            </div>\n\n            {/* Bust Cache Button */}\n            <button\n              onClick={handleBustCache}\n              disabled={bustingCache}\n              className=\"rounded-lg border border-fuchsia-500/40 bg-fuchsia-500/10 px-4 py-2 text-sm font-medium text-fuchsia-300 transition hover:bg-fuchsia-500/20 disabled:opacity-50\"\n            >\n              {bustingCache ? \"Refreshing...\" : \"Refresh from Database\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}